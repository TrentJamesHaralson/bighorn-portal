<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Dashboard - Bighorn Portal</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="/styles.css" />
</head>
<body>
  <nav class="navbar navbar-light bg-white border-bottom px-3">
    <img src="/images/bighorn-small.png" alt="Bighorn" class="logo-compact" />
    <div class="ms-auto">
      <a href="/dashboard" class="btn btn-link fw-bold">Dashboard</a>
      <a href="/invoices" class="btn btn-link">Invoices</a>
      <a href="/vouchers" class="btn btn-link">Vouchers</a>
      <a href="/logout" class="btn btn-outline-secondary ms-2">Logout</a>
    </div>
  </nav>

  <div class="container py-4">
    <h1 class="h4 mb-3">Dashboard</h1>

    <!-- Statistic tiles -->
    <div class="row g-3 mb-4">
      <div class="col-md-3 col-sm-6">
        <div class="card shadow-sm border-0">
          <div class="card-body text-center">
            <div class="text-muted small">Accounts</div>
            <div class="display-6 fw-bold" id="stat_accounts">0</div>
          </div>
        </div>
      </div>
      <div class="col-md-3 col-sm-6">
        <div class="card shadow-sm border-0">
          <div class="card-body text-center">
            <div class="text-muted small">Active Users</div>
            <div class="display-6 fw-bold" id="stat_users">0</div>
          </div>
        </div>
      </div>
      <div class="col-md-3 col-sm-6">
        <div class="card shadow-sm border-0">
          <div class="card-body text-center">
            <div class="text-muted small">Invoices</div>
            <div class="display-6 fw-bold" id="stat_invoices">0</div>
          </div>
        </div>
      </div>
      <div class="col-md-3 col-sm-6">
        <div class="card shadow-sm border-0">
          <div class="card-body text-center">
            <div class="text-muted small">Vouchers</div>
            <div class="display-6 fw-bold" id="stat_vouchers">0</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Welcome / summary card -->
    <div class="card shadow-sm border-0">
      <div class="card-body">
        <h2 class="h5 mb-2">Welcome to the Bighorn Portal</h2>
        <p class="text-muted mb-0">
          Use the navigation links above to manage invoices, view vouchers, and monitor account activity.
          The dashboard tiles above show live summary counts across your organization.
        </p>
      </div>
    </div>
  </div>

  <script>
    async function fetchJSON(url) {
      const r = await fetch(url);
      if (!r.ok) throw new Error(await r.text());
      return r.json();
    }

    async function loadStats() {
      try {
        const s = await fetchJSON("/api/stats");
        document.getElementById("stat_accounts").textContent = s.accounts;
        document.getElementById("stat_users").textContent = s.active_users;
        document.getElementById("stat_invoices").textContent = s.invoices;
        document.getElementById("stat_vouchers").textContent = s.vouchers;
      } catch (err) {
        console.error("Failed to load stats", err);
      }
    }

    loadStats();
  </script>
</body>
</html>
